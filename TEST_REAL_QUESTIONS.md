# 真實問題測試報告 (v24.1.10)
## 10 個多樣化問題 + 邏輯檢查

### 測試說明
- 所有問題都是**自然用戶語言**，不直接擷取 CLASS_RULES
- 預期：系統應識別關鍵字或型號，決定是否載入 PDF
- 標準：有 PDF 命中則記錄，無則記錄「命中 CLASS_RULES 但無 PDF」或「無匹配」

---

## 問題 1: Odyssey 3D 遊戲相關
**用戶問題：** 
```
我想玩3D遊戲，聽說三星有特殊的螢幕可以不用眼鏡看3D，請問怎麼樣才能享受3D遊戲體驗？
```

**預期邏輯：**
- ✅ 命中直通車：「Odyssey 3D」或「3D遊戲」
- ✅ 從 CLASS_RULES 提取：Odyssey 3D (G90XF)
- ✅ 注入型號：G90XF
- ✅ 載入 PDF：S27FG900 相關手冊
- 📊 **預期日誌：**
  ```
  [DirectDeep] 命中 ODYSSEY3D
  [DirectDeep] 查詢 KEYWORD_MAP[Odyssey3D] = 裸視3D電競螢幕(G90XF)...
  [DirectDeep] 從映射值提取型號: G90XF
  [DirectDeep] ✅ 注入型號到 Cache: G90XF
  [KB Select] 讀取直通車注入型號: G90XF
  [KB Select] 🎯 命中型號: G90XF → 載入 PDF
  ```

---

## 問題 2: Smart Monitor 功能查詢
**用戶問題：**
```
我想要一台螢幕可以直接看Netflix，不需要接電腦，有推薦的嗎？
```

**預期邏輯：**
- ✅ 命中直通車：「SmartMonitor」或「Smart」系列
- ✅ 從 CLASS_RULES 提取：M5、M7、M8、M9
- ✅ 載入 PDF：多個 M 系列手冊
- 📊 **預期日誌：**
  ```
  [DirectDeep] 命中 SmartMonitor
  [DirectDeep] 從映射值提取型號: M50D, M70D, M80D, M90...
  [KB Select] 🎯 命中型號: M70D, M80D... → 載入 PDF
  ```

---

## 問題 3: 特定技術詞彙 (OLED)
**用戶問題：**
```
OLED螢幕跟一般LCD螢幕差在哪裡？三星的OLED螢幕哪個型號最新？
```

**預期邏輯：**
- ✅ 命中直通車：「OLED」術語
- ✅ 從 CLASS_RULES 取得定義：「OLED自發光面板，特色是純黑表現...」
- ❌ **無型號提取**（術語本身不含型號）
- 📊 **預期日誌：**
  ```
  [DirectDeep] 命中 OLED
  [DirectDeep] 從映射值提取型號: NONE (術語無型號)
  [KB Select] Tier0: 0, Tier1: 0 (No Match: none), Total: 0
  [FastMode] 使用 CLASS_RULES 定義回答
  ```

---

## 問題 4: 解析度術語 + 用途結合
**用戶問題：**
```
我是圖片編輯設計師，需要5K高解析度的螢幕，有什麼推薦？
```

**預期邏輯：**
- ✅ 命中直通車：「5K」術語
- ✅ 從 CLASS_RULES 取得定義
- ❌ **無型號提取** (5K 是術語，不是型號)
- ✅ 但用戶提「設計」→ 可能也能匹配 ViewFinity 系列
- 📊 **預期日誌：**
  ```
  [DirectDeep] 命中 5K
  [DirectDeep] 從映射值提取型號: NONE
  [KB Select] 命中 0 個 PDF (5K 無對應型號)
  [FastMode] 搜索 QA + CLASS_RULES
  ```

---

## 問題 5: 型號直接查詢 (無直通車)
**用戶問題：**
```
S27FG900這台螢幕的價格多少？有什麼特色？
```

**預期邏輯：**
- ❌ 不命中直通車（直接是型號）
- ✅ 但 `getRelevantKBFiles()` 應該從訊息提取「S27FG900」
- ✅ 載入 PDF：S27FG900 手冊
- 📊 **預期日誌：**
  ```
  [DirectDeep] 未命中直通車
  [KB Select] 🎯 命中型號: S27FG900 → 載入 PDF
  ```

---

## 問題 6: 多型號對比
**用戶問題：**
```
M7和M8有什麼差別？哪個更適合辦公室用？
```

**預期邏輯：**
- ❌ 不命中直通車（用戶直接說型號別稱）
- ✅ 從訊息提取「M7」和「M8」
- ✅ 載入 PDF：M7、M8 手冊
- 📊 **預期日誌：**
  ```
  [KB Select] 🎯 命中型號: M70D, M80D → 載入 PDF
  ```

---

## 問題 7: 遊戲術語 + 硬體功能
**用戶問題：**
```
我想要一台240Hz的螢幕來玩FPS射擊遊戲，有推薦嗎？
```

**預期邏輯：**
- ✅ 命中直通車：「240Hz」術語
- ✅ 從 CLASS_RULES 取得定義
- ❌ **無型號提取**（術語本身無型號，但用戶搜索會匹配 QA）
- 📊 **預期日誌：**
  ```
  [DirectDeep] 命中 240Hz
  [DirectDeep] 從映射值提取型號: NONE
  [KB Select] Tier0: 0, Tier1: 0, Total: 0
  [FastMode] 使用 QA 回答
  ```

---

## 問題 8: 曲面 + 尺寸組合
**用戶問題：**
```
我要一台27吋曲面的電競螢幕，聽說有1000R曲度，請問有哪些型號？
```

**預期邏輯：**
- ✅ 命中直通車：「1000R」術語
- ✅ 從 CLASS_RULES 取得定義
- ❌ **無型號提取**（術語無型號）
- 📊 **預期日誌：**
  ```
  [DirectDeep] 命中 1000R
  [DirectDeep] 從映射值提取型號: NONE
  [KB Select] Tier0: 0, Tier1: 0, Total: 0
  [FastMode] 搜索 QA (會找到 G55C、G65B... 等 1000R 型號)
  ```

---

## 問題 9: 介面技術 (USB-C、Thunderbolt)
**用戶問題：**
```
我需要一台有USB-C充電功能的螢幕，可以邊充邊工作，你們有這種嗎？
```

**預期邏輯：**
- ✅ 命中直通車：「Type-C」術語
- ✅ 從 CLASS_RULES 取得定義：「USB-C介面(含供電)...」
- ❌ **無型號提取**
- 📊 **預期日誌：**
  ```
  [DirectDeep] 命中 Type-C
  [DirectDeep] 從映射值提取型號: NONE
  [KB Select] Tier0: 0, Tier1: 0, Total: 0
  [FastMode] 搜索 QA (會找到 M7、M8、M9 等支援 USB-C 的型號)
  ```

---

## 問題 10: 活動相關 (時效性)
**用戶問題：**
```
最近有什麼活動或促銷嗎？S27FG900有折扣嗎？
```

**預期邏輯：**
- ✅ 提到型號「S27FG900」
- ✅ 提到活動關鍵字「促銷」「折扣」
- ✅ 從 CLASS_RULES 活動欄查到「雙11限時特價」中包含「S27FG900XC($59,900→$49,900)」
- 📊 **預期日誌：**
  ```
  [KB Select] 🎯 命中型號: S27FG900 → 載入 PDF
  [QA Select] 命中活動欄：2025雙11限時特價
  ```

---

## 邏輯檢查清單

| 問題 | 直通車 | 型號提取 | PDF 命中 | 預期模式 | 狀態 |
|------|-------|---------|---------|---------|------|
| 1. Odyssey 3D 遊戲 | ✅ | ✅ (G90XF) | ✅ | DeepMode + PDF | 需測試 |
| 2. SmartMonitor | ✅ | ✅ (M系列) | ✅ | DeepMode + PDF | 需測試 |
| 3. OLED 術語 | ✅ | ❌ (無型號) | ❌ | FastMode | 需測試 |
| 4. 5K + 設計 | ✅ | ❌ (無型號) | ❌ | FastMode | 需測試 |
| 5. S27FG900 型號 | ❌ | ✅ (直接提)| ✅ | FastMode + PDF | 需測試 |
| 6. M7 vs M8 | ❌ | ✅ (M系列) | ✅ | FastMode + PDF | 需測試 |
| 7. 240Hz 遊戲 | ✅ | ❌ (無型號) | ❌ | FastMode | 需測試 |
| 8. 1000R 曲面 | ✅ | ❌ (無型號) | ❌ | FastMode | 需測試 |
| 9. USB-C 充電 | ✅ | ❌ (無型號) | ❌ | FastMode | 需測試 |
| 10. 促銷 + S27FG900 | ❌ | ✅ (型號+活動) | ✅ | FastMode + PDF | 需測試 |

---

## 邏輯漏洞風險清單

### 🔴 **高優先級風險**

1. **術語命中但無型號提取**
   - 問題 3, 4, 7, 8, 9 都會命中直通車，但無法提取型號
   - ❌ **風險：** 系統顯示「命中直通車」但 PDF 為 0
   - ✅ **預期修復：** v24.1.10 的詳細日誌應顯示「從映射值提取型號: NONE」

2. **SmartMonitor 別稱映射**
   - 問題 2 使用「SmartMonitor」，但 KEYWORD_MAP 中的 key 是什麼？
   - ❌ **風險：** 如果 key 是「SmartMonitor」但用戶說「Smart」，可能無法命中

3. **M 系列型號提取**
   - M7、M8 是別稱，但對應的型號是 M70D、M80D、S27M7* 等
   - ❌ **風險：** 用戶說「M7」，系統是否正確提取到 M70D 並載入 PDF？

### 🟡 **中優先級風險**

4. **多重型號匹配上限**
   - 問題 2 會提取多個型號（M5、M7、M8、M9），但上限是 `MAX_TIER1_COUNT = 2`
   - ⚠️ **風險：** 只會載入 2 個 PDF，其他被截斷
   - ✅ **預期行為：** 只載入前 2 個，其他用 QA 補充

5. **活動欄不在 KEYWORD_MAP**
   - 問題 10 涉及活動，但「活動_2025雙11限時特價」可能不會被直通車命中
   - ⚠️ **風險：** 系統無法自動識別活動資訊

---

## 測試步驟

1. 在 LINE Bot 中逐一提出上述 10 個問題
2. 觀察每個問題的日誌輸出
3. 檢查是否符合「預期日誌」
4. 記錄任何異常（例如 PDF 無故不載入、型號提取失敗等）
5. 根據結果調整邏輯

